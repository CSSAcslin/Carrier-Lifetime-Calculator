<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; }
        h1 { color: #2e7d32; 
            border-bottom: 2px solid #4caf50; }
        h2 { color: #388e3c; }
        h3 { color: black; }
        .code-block { 
            background-color: #e8f5e9; 
            border: 1px solid #c8e6c9;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            overflow-x: auto;
        }
        .param-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .param-table th {
            background-color: #4caf50;
            color: white;
            text-align: left;
            padding: 8px;
        }
        .param-table td {
            border: 1px solid #c8e6c9;
            padding: 8px;
        }
        .param-table tr:nth-child(even) {
            background-color: #f1f8e9;
        }
        .note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px;
            margin: 10px 0;
        }
        .math-block {
            font-size: large;
            background-color: #f9fbe7;
            border: 1px solid #dcedc8;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            overflow-x: auto;
        }
    </style>
    <title>stft_help</title>
</head>
<body>
    <h1>CWT(连续小波变换)分析</h1>

<h2>1. 功能概述</h2>
<p>CWT(Continuous Wavelet Transform)是一种先进的时频分析方法，通过不同尺度的小波函数分析信号的局部特征。相比STFT，CWT在时频分辨率上具有更好的灵活性，特别适合分析非平稳信号和瞬态现象。</p>

<h2>2. 算法原理</h2>
<p>CWT通过将信号与小波基函数进行卷积变换：</p>
<p class="math-block">C(a, b) = <sup>1</sup>/<sub>√a</sub> ∫<sub>-∞</sub><sup>∞</sup> x(t) ψ*((t-b)/a) dt</p>
<p>其中：</p>
<ul>
    <li><b>a</b>：尺度参数（与频率相关）</li>
    <li><b>b</b>：平移参数（与时间相关）</li>
    <li><b>ψ(t)</b>：小波基函数</li>
    <li><b>ψ*</b>：小波基函数的复共轭</li>
</ul>
<p>尺度a与频率f的关系为：</p>
<p class="math-block">f = <sup>f<sub>c</sub></sup>/<sub>a</sub></p>
<p>其中f<sub>c</sub>是小波的中心频率。</p>

<h2>3. 参数说明</h2>
<table class="param-table">
    <tr>
        <th>参数</th>
        <th>默认值</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>目标频率</td>
        <td>30.0 Hz</td>
        <td>需要分析的目标频率(Hz)</td>
    </tr>
    <tr>
        <td>小波类型</td>
        <td>cmor</td>
        <td>选择小波基函数类型，详解见下</td>
    </tr>
    <tr>
        <td>采样帧率</td>
        <td>300</td>
        <td>视频或时序数据的采样帧率(帧/秒)</td>
    </tr>
    <tr>
        <td>计算尺度</td>
        <td>256/1</td>
        <td>实际计算频率的数量，影响频率分辨能力（质量评价中256，实际运算中默认为1，即只算目标频率）</td>
    </tr>
    <tr>
        <td>处理跨度</td>
        <td>1</td>
        <td>分析频率范围(Hz)，以目标频率为中心（质量评价中用不到），在这个范围内，会取<i>计算尺度</i>个点进行cwt</td>
    </tr>
</table>

<h2>4. 小波基函数</h2>
<p>目前本程序支持以下小波基函数：</p>
<table class="param-table">
    <tr>
        <th>函数</th>
        <th>名称</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>cmor3-3</td>
        <td>复Morlet小波-宽</td>
        <td>最主要用的小波</td>
    </tr>
    <tr>
        <td>cmor1.5-1.0</td>
        <td>复Morlet小波-窄</td>
        <td>高频率分辨，低时间分辨</td>
    </tr>
    <tr>
        <td>cgau8</td>
        <td>8阶复高斯小波</td>
        <td>对突变敏感，低频率分辨，高时间分辨</td>
    </tr>
        <tr>
        <td>mexh</td>
        <td>墨西哥帽小波</td>
        <td>实小波，对突变敏感，低频率分辨</td>
    </tr>
    <tr>
        <td>morl</td>
        <td>实Morlet小波</td>
        <td>实小波，一般不用，无相位信息</td>
    </tr>
</table>
<h3>cmor3-3 (复Morlet小波)</h3>
<p>复Morlet小波由高斯函数调制复指数构成：</p>
<p class="math-block">ψ(t) = <sup>1</sup>/<sub>√πf<sub>b</sub></sub> e<sup>j2πf<sub>c</sub>t</sup> e<sup>-t²/f<sub>b</sub></sup></p>
<p>其中f<sub>b</sub>=3为带宽参数，f<sub>c</sub>=3为中心频率。</p>
<p><b>特点：</b></p>
<ul>
    <li>提供复数结果（幅度和相位信息）</li>
    <li>良好的时频局部化特性</li>
    <li>适用于精确频率分析</li>
</ul>

<h3>cmor1.5-1.0 (窄带复Morlet小波)</h3>
<p>带宽参数f<sub>b</sub>=1.5，中心频率f<sub>c</sub>=1.0。</p>
<p><b>特点：</b></p>
<ul>
    <li>更高的频率分辨率</li>
    <li>较低的时间分辨率</li>
    <li>适合分析准稳态信号</li>
</ul>

<h3>cgau8 (8阶复高斯小波)</h3>
<p>8阶复高斯小波：</p>
<p class="math-block">ψ(t) = <sup>d⁸</sup>/<sub>dt⁸</sub> (e<sup>-t²/2</sup> e<sup>jωt</sup>)</p>
<p><b>特点：</b></p>
<ul>
    <li>高阶导数提供更好的瞬态检测</li>
    <li>对信号突变敏感</li>
    <li>适合检测边缘和瞬态事件</li>
</ul>

<h3>mexh (墨西哥帽小波)</h3>
<p>墨西哥帽小波是高斯函数的二阶导数：</p>
<p class="math-block">ψ(t) = (1 - t²) e<sup>-t²/2</sup></p>
<p><b>特点：</b></p>
<ul>
    <li>实值小波（仅幅度信息）</li>
    <li>对信号突变高度敏感</li>
    <li>常用于边缘检测和特征提取</li>
    <li>计算效率高</li>
</ul>

<h3>morl(实Morlet小波)</h3>
<p>实部Morlet小波：</p>
<p class="math-block">ψ(t) = e<sup>-t²/2</sup> cos(5t)</p>
<p><b>特点：</b></p>
<ul>
    <li>实数结果（仅幅度信息）</li>
    <li>计算效率高</li>
    <li>适合实时处理</li>
</ul>

<h2>5. 处理流程</h2>
<ol>
    <li><b>数据预处理</b>：加载视频或时序数据，进行降噪和归一化</li>
    <li><b>参数设置</b>：根据信号特性选择小波类型和参数</li>
    <li><b>质量评价</b>：计算得到时频图</li>
    <li><b>CWT计算</b>：对每个像素/通道执行连续小波变换</li>
    <li><b>后处理</b>：后续可以进行全细胞/单细胞分析</li>
    <li><b>可视化</b>：可以对cwt结果进行可视化呈现</li>
</ol>
<h2>7. 时频分辨率分析</h2>
<p>和短时傅里叶变换相比，小波变换有着窗口自适应的特点，即<b>高频信号分辨率高（但是频率分辨率差），低频信号频率分辨率高（但是时间分辨率差）</b></p>

<h3>7.1 不确定性原理</h3>
<p>时频分辨率受海森堡不确定性原理约束：</p>
<p class="math-block">ΔT · ΔF ≥ <sup>1</sup>/<sub>4π</sub></p>
<p>其中ΔT为时间分辨率，ΔF为频率分辨率。</p>

<h3>7.2 不同小波的时频特性</h3>
<table class="param-table">
    <tr>
        <th>小波类型</th>
        <th>时间分辨率</th>
        <th>频率分辨率</th>
        <th>适用场景</th>
    </tr>
    <tr>
        <td>cmor3-3</td>
        <td>中等</td>
        <td>中等</td>
        <td>通用分析</td>
    </tr>
    <tr>
        <td>cmor1.5-1.0</td>
        <td>低</td>
        <td>高</td>
        <td>精确频率分析</td>
    </tr>
    <tr>
        <td>cgau8</td>
        <td>很高</td>
        <td>很低</td>
        <td>边缘和突变检测</td>
    </tr>
    <tr>
        <td>mexh(实)</td>
        <td>高</td>
        <td>低</td>
        <td>特征提取/边缘检测</td>
    </tr>
    <tr>
        <td>morl(实)</td>
        <td>高</td>
        <td>低</td>
        <td>瞬态事件检测</td>
    </tr>
</table>

<!-- <h3>7.3 尺度选择的影响</h3>
<ul>
    <li><b>尺度数量多</b>：频率分辨率高，计算时间长</li>
    <li><b>尺度数量少</b>：频率分辨率低，计算时间短</li>
    <li><b>处理跨度大</b>：分析频率范围宽，分辨率降低</li>
    <li><b>处理跨度小</b>：分析频率范围窄，分辨率提高</li>
</ul> -->

    <p><i>附：程序使用<a href="https://pywavelets.readthedocs.io/en/latest/ref/cwt.html">
        pywt.cwt</a>方法进行运算</i></p>
</body>
</html>